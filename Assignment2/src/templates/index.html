<!DOCTYPE html>
<html>
<head>
    <title>RAG Demo</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; max-width: 800px; }
        textarea { width: 100%; height: 80px; padding: 10px; font-size: 14px; }
        button { padding: 10px 18px; font-size: 14px; cursor: pointer; }
        .chunk { background: #f3f3f3; padding: 12px; margin-top: 12px; border-radius: 6px; }
        .answer-box {
    background: #e8f5ff;
    padding: 12px;
    margin-top: 12px;
    border-radius: 6px;
    white-space: pre-wrap;
    word-wrap: break-word;
    overflow-wrap: break-word;
}
        h2, h3 { margin-top: 30px; }
    </style>
</head>
<body>

<h2>RAG Search Demo</h2>

<form method="POST">
    <textarea name="query" placeholder="Ask something..."></textarea>
    <br><br>
    <button type="submit">Submit</button>
</form>

{% if llm_answer %}
    <h3>Pure LLM Answer</h3>
    <pre class="answer-box">{{ llm_answer }}</pre>
{% endif %}

{% if rag_answer %}
    <h3>RAG Answer (LLM + Retrieved Context)</h3>
    <pre class="answer-box">{{ rag_answer }}</pre>
{% endif %}

{% if chunks %}
    <h3>Retrieved Chunks</h3>
    {% for c in chunks %}
        <div class="chunk">
            <b>{{ c.chunk_id }} â€” score {{ c.score }}</b>
            <p>{{ c.text }}</p>
        </div>
    {% endfor %}
{% endif %}

{% if heatmaps %}
    <h3>Retrieval Heatmaps</h3>

    <h4>Dense Similarity</h4>
    <img src="{{ heatmaps[0] }}" style="width:100%;">

    <h4>BM25 Similarity</h4>
    <img src="{{ heatmaps[1] }}" style="width:100%;">
{% endif %}


</body>
</html>
